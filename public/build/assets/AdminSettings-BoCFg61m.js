import{r as B,n as L}from"./uploads-CnEkgyD_.js";import{_ as T,c as F,b as l,a as e,r,w as s,f as m,e as I,C as P,g as j,o as V}from"./app-CnnV-4Hh.js";const A={data(){return{settings:{general:{site_name:{value:"",type:"text",group:"general"}},branding:{logo:{value:"",type:"image",group:"branding"}},footer:{powered_by_text:{value:"Powered By CPB-IT",type:"text",group:"footer"},version:{value:"v1.0",type:"text",group:"footer"},copyright_text:{value:"All Rights Reserved",type:"text",group:"footer"}}},loading:!1,logoFile:null,uploadingLogo:!1}},computed:{logoUrl(){return this.settings.branding.logo.value?this.resolveImageUrl(this.settings.branding.logo.value):null}},async mounted(){await this.loadSettings()},methods:{async loadSettings(){try{const a=localStorage.getItem("admin_token"),n=(await this.$axios.get("/api/v1/settings",{headers:{Authorization:`Bearer ${a}`}})).data;Object.keys(n).forEach(i=>{this.settings[i]?Object.keys(n[i]).forEach(o=>{this.settings[i][o]?(this.settings[i][o].value=n[i][o].value||"",n[i][o].type&&(this.settings[i][o].type=n[i][o].type),n[i][o].group&&(this.settings[i][o].group=n[i][o].group)):this.settings[i][o]={value:n[i][o].value||"",type:n[i][o].type||"text",group:n[i][o].group||i}}):(this.settings[i]={},Object.keys(n[i]).forEach(o=>{this.settings[i][o]={value:n[i][o].value||"",type:n[i][o].type||"text",group:n[i][o].group||i}}))})}catch(a){console.error("Error loading settings:",a),this.showError("Failed to load settings")}},async saveSettings(){this.loading=!0;try{const a=localStorage.getItem("admin_token"),t={};Object.keys(this.settings).forEach(n=>{Object.keys(this.settings[n]).forEach(i=>{t[i]=this.settings[n][i]})}),await this.$axios.post("/api/v1/settings",{settings:t},{headers:{Authorization:`Bearer ${a}`}}),this.showSuccess("Settings saved successfully")}catch(a){console.error("Error saving settings:",a);let t="Error saving settings";a.response&&a.response.data&&a.response.data.message?t=a.response.data.message:a.message&&(t=a.message),this.showError(t)}finally{this.loading=!1}},showSuccess(a){window.Toast?window.Toast.fire({icon:"success",title:a}):alert(a)},showError(a){window.Toast?window.Toast.fire({icon:"error",title:a}):alert(a)},async handleLogoUpload(){var n,i;if(!this.logoFile)return;const a=Array.isArray(this.logoFile)?this.logoFile[0]:this.logoFile;if(!a)return;if(!a.type.startsWith("image/")){this.showError("Please select a valid image file"),this.logoFile=null;return}const t=5*1024*1024;if(a.size>t){this.showError("File size must be less than 5MB"),this.logoFile=null;return}this.uploadingLogo=!0;try{const o=new FormData;o.append("image",a),o.append("folder","branding");const g=localStorage.getItem("admin_token"),d=await this.$axios.post("/api/v1/upload/image",o,{headers:{Authorization:`Bearer ${g}`,"Content-Type":"multipart/form-data"}});if(d.data.success){const u=this.normalizeImageInput(d.data.path||d.data.url);this.settings.branding.logo.value=u,this.logoFile=null,this.showSuccess("Logo uploaded successfully")}else throw new Error(d.data.message||"Failed to upload logo")}catch(o){console.error("Error uploading logo:",o),this.showError(((i=(n=o.response)==null?void 0:n.data)==null?void 0:i.message)||o.message||"Failed to upload logo"),this.logoFile=null}finally{this.uploadingLogo=!1}},clearLogo(){this.settings.branding.logo.value="",this.logoFile=null},normalizeImageInput(a){return L(a)},resolveImageUrl(a){return B(a)}}},k={class:"settings-page"},M={class:"settings-header mb-8"},N={class:"header-content"},G={class:"header-icon-wrapper"},O={class:"d-flex align-center"},R={class:"section-label mb-2"},D={class:"section-label mb-2 mt-2"},W={class:"d-flex align-center"},J={class:"d-flex align-center mb-4"},q={key:0,class:"logo-preview-wrapper mb-4"},H={class:"logo-preview-container"},K={class:"logo-image-wrapper"},Q={class:"logo-preview-actions-top"},X={class:"d-flex align-center justify-center fill-height"},Y={class:"d-flex align-center justify-center fill-height text-error"},Z={class:"d-flex align-center"};function $(a,t,n,i,o,g){const d=r("v-icon"),u=r("v-btn"),x=r("v-avatar"),y=r("v-card-title"),b=r("v-card-subtitle"),w=r("v-card-item"),S=r("v-divider"),v=r("v-text-field"),p=r("v-col"),_=r("v-row"),h=r("v-card-text"),f=r("v-card"),z=r("v-progress-circular"),U=r("v-img"),C=r("v-file-input"),E=r("v-form");return V(),F("div",k,[l("div",M,[l("div",N,[l("div",G,[e(d,{icon:"mdi-cog",size:"48",class:"header-icon"})]),t[5]||(t[5]=l("div",{class:"header-text"},[l("h1",{class:"text-h4 font-weight-bold mb-2"},"Settings"),l("p",{class:"text-body-1 text-medium-emphasis"},"Manage your application preferences and configurations ")],-1))]),e(u,{color:"primary",size:"large","prepend-icon":"mdi-content-save",loading:o.loading,onClick:g.saveSettings,elevation:"2",class:"save-btn"},{default:s(()=>t[6]||(t[6]=[m(" Save Changes ")])),_:1,__:[6]},8,["loading","onClick"])]),e(E,{onSubmit:j(g.saveSettings,["prevent"])},{default:s(()=>[e(_,null,{default:s(()=>[e(p,{cols:"12"},{default:s(()=>[e(f,{class:"settings-card",elevation:"2",rounded:"xl"},{default:s(()=>[e(w,{class:"card-header compact-header"},{default:s(()=>[l("div",O,[e(x,{size:"36",color:"primary",class:"mr-3"},{default:s(()=>[e(d,{icon:"mdi-cog",color:"white",size:"20"})]),_:1}),l("div",null,[e(y,{class:"pa-0 text-subtitle-1 font-weight-bold"},{default:s(()=>t[7]||(t[7]=[m("General & Footer Settings")])),_:1,__:[7]}),e(b,{class:"pa-0 text-caption"},{default:s(()=>t[8]||(t[8]=[m("Basic information and footer customization")])),_:1,__:[8]})])])]),_:1}),e(S),e(h,{class:"pa-4"},{default:s(()=>[e(_,{dense:""},{default:s(()=>[e(p,{cols:"12"},{default:s(()=>[l("div",R,[e(d,{icon:"mdi-information",size:"16",class:"mr-1"}),t[9]||(t[9]=l("span",{class:"text-caption font-weight-bold text-uppercase"},"General",-1))]),e(v,{modelValue:o.settings.general.site_name.value,"onUpdate:modelValue":t[0]||(t[0]=c=>o.settings.general.site_name.value=c),label:"Site Name",variant:"outlined",density:"compact",color:"primary","prepend-inner-icon":"mdi-web",hint:"The name of your website","persistent-hint":"","hide-details":"auto"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12"},{default:s(()=>[l("div",D,[e(d,{icon:"mdi-text-box",size:"16",class:"mr-1"}),t[10]||(t[10]=l("span",{class:"text-caption font-weight-bold text-uppercase"},"Footer",-1))])]),_:1}),e(p,{cols:"12",md:"6"},{default:s(()=>[e(v,{modelValue:o.settings.footer.powered_by_text.value,"onUpdate:modelValue":t[1]||(t[1]=c=>o.settings.footer.powered_by_text.value=c),label:"Powered By Text",variant:"outlined",density:"compact",color:"primary","prepend-inner-icon":"mdi-text",hint:"Text displayed next to logo in footer","persistent-hint":"","hide-details":"auto"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:s(()=>[e(v,{modelValue:o.settings.footer.version.value,"onUpdate:modelValue":t[2]||(t[2]=c=>o.settings.footer.version.value=c),label:"Version",variant:"outlined",density:"compact",color:"primary","prepend-inner-icon":"mdi-tag",hint:"Application version displayed in footer","persistent-hint":"","hide-details":"auto"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12"},{default:s(()=>[e(v,{modelValue:o.settings.footer.copyright_text.value,"onUpdate:modelValue":t[3]||(t[3]=c=>o.settings.footer.copyright_text.value=c),label:"Copyright Text",variant:"outlined",density:"compact",color:"primary","prepend-inner-icon":"mdi-copyright",hint:"Copyright text (year will be added automatically)","persistent-hint":"","hide-details":"auto"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(p,{cols:"12"},{default:s(()=>[e(f,{class:"settings-card",elevation:"2",rounded:"xl"},{default:s(()=>[e(w,{class:"card-header"},{default:s(()=>[l("div",W,[e(x,{size:"40",color:"purple",class:"mr-4"},{default:s(()=>[e(d,{icon:"mdi-palette",color:"white"})]),_:1}),l("div",null,[e(y,{class:"pa-0 text-h6 font-weight-bold"},{default:s(()=>t[11]||(t[11]=[m("Branding")])),_:1,__:[11]}),e(b,{class:"pa-0"},{default:s(()=>t[12]||(t[12]=[m("Customize the look and feel of your site")])),_:1,__:[12]})])])]),_:1}),e(S),e(h,{class:"pa-6"},{default:s(()=>[e(_,{justify:"center"},{default:s(()=>[e(p,{cols:"12",md:"8",lg:"6"},{default:s(()=>[e(f,{variant:"outlined",class:"logo-upload-card pa-6",rounded:"lg"},{default:s(()=>[l("div",J,[e(d,{icon:"mdi-image",size:"24",class:"mr-2",color:"primary"}),t[13]||(t[13]=l("span",{class:"text-subtitle-1 font-weight-bold"},"Logo",-1))]),o.settings.branding.logo.value?(V(),F("div",q,[l("div",H,[l("div",K,[l("div",Q,[e(u,{size:"small",variant:"flat",color:"error","prepend-icon":"mdi-delete",onClick:g.clearLogo,class:"remove-logo-btn"},{default:s(()=>t[14]||(t[14]=[m(" Remove Logo ")])),_:1,__:[14]},8,["onClick"])]),e(U,{src:g.logoUrl,alt:"Logo Preview","max-height":120,"max-width":300,contain:"",class:"logo-preview-image",eager:""},{placeholder:s(()=>[l("div",X,[e(z,{indeterminate:"",color:"primary"})])]),error:s(()=>[l("div",Y,[e(d,{icon:"mdi-alert-circle",class:"mr-2"}),t[15]||(t[15]=l("span",null,"Failed to load image",-1))])]),_:1},8,["src"])])])])):I("",!0),e(C,{modelValue:o.logoFile,"onUpdate:modelValue":[t[4]||(t[4]=c=>o.logoFile=c),g.handleLogoUpload],label:"Upload Logo",variant:"outlined",density:"comfortable",color:"primary",accept:"image/*","prepend-icon":"mdi-upload",hint:"Upload a logo image (JPG, PNG, GIF, WebP - Max 5MB). Recommended size: 200x60px or 300x90px","persistent-hint":"","show-size":"",class:"mb-4"},P({_:2},[o.uploadingLogo?{name:"append-inner",fn:s(()=>[e(z,{indeterminate:"",size:"20",color:"primary"})]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(f,{class:"save-bar-card",elevation:"8",rounded:"lg"},{default:s(()=>[e(h,{class:"d-flex align-center justify-space-between pa-4"},{default:s(()=>[l("div",Z,[e(d,{icon:"mdi-information-outline",class:"mr-2",color:"primary"}),t[16]||(t[16]=l("span",{class:"text-body-2 mr-2"},"Make sure to save your changes",-1))]),e(u,{color:"primary",size:"large","prepend-icon":"mdi-content-save",loading:o.loading,onClick:g.saveSettings,elevation:"2"},{default:s(()=>t[17]||(t[17]=[m(" Save Changes ")])),_:1,__:[17]},8,["loading","onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])])}const oe=T(A,[["render",$],["__scopeId","data-v-a499ae41"]]);export{oe as default};
